"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports["default"] = void 0;var _firebase = require("./firebase");

var teamsRef = _firebase.db.collection('teams');
var usersRef = _firebase.db.collection('users');
var channelsRef = _firebase.db.collection('channels');

var driver = {
  teams: {
    get: get(teamsRef),
    save: save(teamsRef),
    all: all(teamsRef) },

  channels: {
    get: get(channelsRef),
    save: save(channelsRef),
    all: all(channelsRef) },

  users: {
    get: get(usersRef),
    save: save(usersRef),
    all: all(usersRef) } };var _default =


driver;exports["default"] = _default;

function get(firebaseRef) {
  return function (id) {return new Promise(function (resolve, reject) {return firebaseRef.doc(id).get().then(function (doc) {
        if (!doc.exists) {
          reject(Error('Document not found'));
        } else {
          resolve(doc.data());
        }
      })["catch"](reject);});};
}

function save(firebaseRef) {
  return function (data) {return firebaseRef.doc(data.id).set(data, { merge: true });};
}

function all(firebaseRef) {
  return function () {return new Promise(function (resolve, reject) {return firebaseRef.get().then(function (snapshot) {
        resolve(snapshot.toArray().map(function (doc) {return doc.data();}));
      })["catch"](reject);});};
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL2luZGV4LmpzIl0sIm5hbWVzIjpbInRlYW1zUmVmIiwiZGIiLCJjb2xsZWN0aW9uIiwidXNlcnNSZWYiLCJjaGFubmVsc1JlZiIsImRyaXZlciIsInRlYW1zIiwiZ2V0Iiwic2F2ZSIsImFsbCIsImNoYW5uZWxzIiwidXNlcnMiLCJmaXJlYmFzZVJlZiIsImlkIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJkb2MiLCJ0aGVuIiwiZXhpc3RzIiwiRXJyb3IiLCJkYXRhIiwic2V0IiwibWVyZ2UiLCJzbmFwc2hvdCIsInRvQXJyYXkiLCJtYXAiXSwibWFwcGluZ3MiOiJ1R0FBQTs7QUFFQSxJQUFNQSxRQUFRLEdBQUdDLGFBQUdDLFVBQUgsQ0FBYyxPQUFkLENBQWpCO0FBQ0EsSUFBTUMsUUFBUSxHQUFHRixhQUFHQyxVQUFILENBQWMsT0FBZCxDQUFqQjtBQUNBLElBQU1FLFdBQVcsR0FBR0gsYUFBR0MsVUFBSCxDQUFjLFVBQWQsQ0FBcEI7O0FBRUEsSUFBTUcsTUFBTSxHQUFHO0FBQ2JDLEVBQUFBLEtBQUssRUFBRTtBQUNMQyxJQUFBQSxHQUFHLEVBQUVBLEdBQUcsQ0FBQ1AsUUFBRCxDQURIO0FBRUxRLElBQUFBLElBQUksRUFBRUEsSUFBSSxDQUFDUixRQUFELENBRkw7QUFHTFMsSUFBQUEsR0FBRyxFQUFFQSxHQUFHLENBQUNULFFBQUQsQ0FISCxFQURNOztBQU1iVSxFQUFBQSxRQUFRLEVBQUU7QUFDUkgsSUFBQUEsR0FBRyxFQUFFQSxHQUFHLENBQUNILFdBQUQsQ0FEQTtBQUVSSSxJQUFBQSxJQUFJLEVBQUVBLElBQUksQ0FBQ0osV0FBRCxDQUZGO0FBR1JLLElBQUFBLEdBQUcsRUFBRUEsR0FBRyxDQUFDTCxXQUFELENBSEEsRUFORzs7QUFXYk8sRUFBQUEsS0FBSyxFQUFFO0FBQ0xKLElBQUFBLEdBQUcsRUFBRUEsR0FBRyxDQUFDSixRQUFELENBREg7QUFFTEssSUFBQUEsSUFBSSxFQUFFQSxJQUFJLENBQUNMLFFBQUQsQ0FGTDtBQUdMTSxJQUFBQSxHQUFHLEVBQUVBLEdBQUcsQ0FBQ04sUUFBRCxDQUhILEVBWE0sRUFBZixDOzs7QUFpQmVFLE07O0FBRWYsU0FBU0UsR0FBVCxDQUFjSyxXQUFkLEVBQTJCO0FBQ3pCLFNBQU8sVUFBQUMsRUFBRSxVQUFJLElBQUlDLE9BQUosQ0FBWSxVQUFDQyxPQUFELEVBQVVDLE1BQVYsVUFBcUJKLFdBQVcsQ0FBQ0ssR0FBWixDQUFnQkosRUFBaEIsRUFBb0JOLEdBQXBCLEdBQTBCVyxJQUExQixDQUErQixVQUFBRCxHQUFHLEVBQUk7QUFDbEYsWUFBSSxDQUFDQSxHQUFHLENBQUNFLE1BQVQsRUFBaUI7QUFDZkgsVUFBQUEsTUFBTSxDQUFDSSxLQUFLLENBQUMsb0JBQUQsQ0FBTixDQUFOO0FBQ0QsU0FGRCxNQUVPO0FBQ0xMLFVBQUFBLE9BQU8sQ0FBQ0UsR0FBRyxDQUFDSSxJQUFKLEVBQUQsQ0FBUDtBQUNEO0FBQ0YsT0FONkMsV0FNckNMLE1BTnFDLENBQXJCLEVBQVosQ0FBSixFQUFUO0FBT0Q7O0FBRUQsU0FBU1IsSUFBVCxDQUFlSSxXQUFmLEVBQTRCO0FBQzFCLFNBQU8sVUFBQVMsSUFBSSxVQUFJVCxXQUFXLENBQUNLLEdBQVosQ0FBZ0JJLElBQUksQ0FBQ1IsRUFBckIsRUFBeUJTLEdBQXpCLENBQTZCRCxJQUE3QixFQUFtQyxFQUFFRSxLQUFLLEVBQUUsSUFBVCxFQUFuQyxDQUFKLEVBQVg7QUFDRDs7QUFFRCxTQUFTZCxHQUFULENBQWNHLFdBQWQsRUFBMkI7QUFDekIsU0FBTyxvQkFBTSxJQUFJRSxPQUFKLENBQVksVUFBQ0MsT0FBRCxFQUFVQyxNQUFWLFVBQXFCSixXQUFXLENBQUNMLEdBQVosR0FBa0JXLElBQWxCLENBQXVCLFVBQUFNLFFBQVEsRUFBSTtBQUMvRVQsUUFBQUEsT0FBTyxDQUFDUyxRQUFRLENBQUNDLE9BQVQsR0FBbUJDLEdBQW5CLENBQXVCLFVBQUFULEdBQUcsVUFBSUEsR0FBRyxDQUFDSSxJQUFKLEVBQUosRUFBMUIsQ0FBRCxDQUFQO0FBQ0QsT0FGNkMsV0FFckNMLE1BRnFDLENBQXJCLEVBQVosQ0FBTixFQUFQO0FBR0QiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkYiB9IGZyb20gJy4vZmlyZWJhc2UnXG5cbmNvbnN0IHRlYW1zUmVmID0gZGIuY29sbGVjdGlvbigndGVhbXMnKVxuY29uc3QgdXNlcnNSZWYgPSBkYi5jb2xsZWN0aW9uKCd1c2VycycpXG5jb25zdCBjaGFubmVsc1JlZiA9IGRiLmNvbGxlY3Rpb24oJ2NoYW5uZWxzJylcblxuY29uc3QgZHJpdmVyID0ge1xuICB0ZWFtczoge1xuICAgIGdldDogZ2V0KHRlYW1zUmVmKSxcbiAgICBzYXZlOiBzYXZlKHRlYW1zUmVmKSxcbiAgICBhbGw6IGFsbCh0ZWFtc1JlZilcbiAgfSxcbiAgY2hhbm5lbHM6IHtcbiAgICBnZXQ6IGdldChjaGFubmVsc1JlZiksXG4gICAgc2F2ZTogc2F2ZShjaGFubmVsc1JlZiksXG4gICAgYWxsOiBhbGwoY2hhbm5lbHNSZWYpXG4gIH0sXG4gIHVzZXJzOiB7XG4gICAgZ2V0OiBnZXQodXNlcnNSZWYpLFxuICAgIHNhdmU6IHNhdmUodXNlcnNSZWYpLFxuICAgIGFsbDogYWxsKHVzZXJzUmVmKVxuICB9XG59XG5leHBvcnQgZGVmYXVsdCBkcml2ZXJcblxuZnVuY3Rpb24gZ2V0IChmaXJlYmFzZVJlZikge1xuICByZXR1cm4gaWQgPT4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gZmlyZWJhc2VSZWYuZG9jKGlkKS5nZXQoKS50aGVuKGRvYyA9PiB7XG4gICAgaWYgKCFkb2MuZXhpc3RzKSB7XG4gICAgICByZWplY3QoRXJyb3IoJ0RvY3VtZW50IG5vdCBmb3VuZCcpKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXNvbHZlKGRvYy5kYXRhKCkpXG4gICAgfVxuICB9KS5jYXRjaChyZWplY3QpKVxufVxuXG5mdW5jdGlvbiBzYXZlIChmaXJlYmFzZVJlZikge1xuICByZXR1cm4gZGF0YSA9PiBmaXJlYmFzZVJlZi5kb2MoZGF0YS5pZCkuc2V0KGRhdGEsIHsgbWVyZ2U6IHRydWUgfSlcbn1cblxuZnVuY3Rpb24gYWxsIChmaXJlYmFzZVJlZikge1xuICByZXR1cm4gKCkgPT4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gZmlyZWJhc2VSZWYuZ2V0KCkudGhlbihzbmFwc2hvdCA9PiB7XG4gICAgcmVzb2x2ZShzbmFwc2hvdC50b0FycmF5KCkubWFwKGRvYyA9PiBkb2MuZGF0YSgpKSlcbiAgfSkuY2F0Y2gocmVqZWN0KSlcbn1cbiJdfQ==